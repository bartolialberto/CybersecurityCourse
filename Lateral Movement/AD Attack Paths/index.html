
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://bartolialberto.github.io/CybersecurityCourse/Lateral%20Movement/AD%20Attack%20Paths/">
      
      
        <link rel="prev" href="../../Authentication%20-%20NTLM%20Kerberos/Authentication%20-%20Windows/">
      
      
        <link rel="next" href="../AD%20Labs%20and%20Tools/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-9.2.5">
    
    
      
        <title>AD Attack Paths - Cybersecurity Course - University of Trieste</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.0e669242.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.85d0ee34.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-7FK5GG9NWX"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-7FK5GG9NWX",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-7FK5GG9NWX",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="orange" data-md-color-accent="indigo">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ad-attack-paths" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="https://bartoli.inginf.units.it" title="Cybersecurity Course - University of Trieste" class="md-header__button md-logo" aria-label="Cybersecurity Course - University of Trieste" data-md-component="logo">
      
  <img src="../../bernabeu small.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Cybersecurity Course - University of Trieste
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              AD Attack Paths
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://bartoli.inginf.units.it" title="Cybersecurity Course - University of Trieste" class="md-nav__button md-logo" aria-label="Cybersecurity Course - University of Trieste" data-md-component="logo">
      
  <img src="../../bernabeu small.png" alt="logo">

    </a>
    Cybersecurity Course - University of Trieste
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../Topics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Topics
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    1 - Hacking Lab
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            1 - Hacking Lab
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Hacking%20Lab/Lab_Hacking_Metasploitable/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metasploitable3 Hacking Lab
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Hacking%20Lab/Lab_Virtual_Machines/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metasploitable3 Hacking Lab - Installation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Hacking%20Lab/Vulnerable%20Platforms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vulnerable Platforms
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    2 - Access Control
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            2 - Access Control
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Access%20Control/Resources%20-%20Access%20Control/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Access Control - Resources
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    3 - MITRE ATT&CK
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            3 - MITRE ATT&CK
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../MITRE%20ATTACK/ATTACK%20-%20MITRE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MITRE ATT&CK
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../MITRE%20ATTACK/ICS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ICS - Industrial Control Systems
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    4 - Malware
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            4 - Malware
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Malware/Execution%20and%20other%20tactics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Execution and Other Tactics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Malware/Initial%20Access%20Advanced/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Initial Access - Advanced Techniques
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Malware/Initial%20Access/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Initial Access
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Malware/Malware%20detection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Malware detection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Malware/Malware_Case_Studies/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intrusions and Malware - Case studies
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    5 - Passwords
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            5 - Passwords
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Passwords/Passwords/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Passwords
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    6 - Authentication - NTLM Kerberos
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            6 - Authentication - NTLM Kerberos
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Authentication%20-%20NTLM%20Kerberos/Authentication%20-%20Windows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authentication in Windows
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" checked>
        
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    7 - Lateral Movement
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            7 - Lateral Movement
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    AD Attack Paths
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    AD Attack Paths
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#lateral-movement" class="md-nav__link">
    Lateral Movement
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#discovery" class="md-nav__link">
    Discovery
  </a>
  
    <nav class="md-nav" aria-label="Discovery">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tools-for-windows-machines" class="md-nav__link">
    Tools for Windows machines
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bloodhound" class="md-nav__link">
    Bloodhound
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-tools-for-active-directory-environments" class="md-nav__link">
    Other tools for Active Directory environments
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ad-attack-paths_1" class="md-nav__link">
    AD Attack paths
  </a>
  
    <nav class="md-nav" aria-label="AD Attack paths">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#certified-pre-owned" class="md-nav__link">
    Certified Pre-Owned
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#demo-video" class="md-nav__link">
    Demo video
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relaying" class="md-nav__link">
    Relaying
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#appendix-ad-defense-guidance" class="md-nav__link">
    APPENDIX - AD Defense guidance
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#appendix-kerberos-delegation-abuses" class="md-nav__link">
    APPENDIX - Kerberos Delegation Abuses
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../AD%20Labs%20and%20Tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AD Attack Examples and Tools
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    8 - MFA
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            8 - MFA
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../MFA/MFA/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multifactor Authentication (MFA)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    9 - Memory Corruption
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            9 - Memory Corruption
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Memory%20Corruption/Memory%20Corruption%20-%20Case%20studies/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Memory corruption - Case studies
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Memory%20Corruption/Resources%20-%20Memory%20corruption_/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Memory Corruption
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12" >
        
          <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    10 - Vulnerabilities
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12">
            <span class="md-nav__icon md-icon"></span>
            10 - Vulnerabilities
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Vulnerabilities/Resources%20-%20Vulnerabilities%20Intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vulnerabilities Introduction - Resources
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Vulnerabilities/Resources%20-%20Vulnerability%20Management/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vulnerability Management - Resources
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Vulnerabilities/Vulnerability%20-%20Case%20studies/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vulnerabilities - Case Studies
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13" >
        
          <label class="md-nav__link" for="__nav_13" id="__nav_13_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    11 - Defense
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_13">
            <span class="md-nav__icon md-icon"></span>
            11 - Defense
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Defense/Defense%20-%20Resources/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Defense - Resources
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_14" >
        
          <label class="md-nav__link" for="__nav_14" id="__nav_14_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Labs
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_14">
            <span class="md-nav__icon md-icon"></span>
            Labs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Labs/Automated%20Malware%20Analysis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Automated Malware Analysis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Labs/BURP/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BURP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Labs/MITRE_ATTACK_Navigator/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MITRE ATT&CK NAVIGATOR.
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Labs/OWASP%20Juice%20Shop/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OWASP Juice Shop
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../docsify/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Report (Docsify-This)
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#lateral-movement" class="md-nav__link">
    Lateral Movement
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#discovery" class="md-nav__link">
    Discovery
  </a>
  
    <nav class="md-nav" aria-label="Discovery">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tools-for-windows-machines" class="md-nav__link">
    Tools for Windows machines
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bloodhound" class="md-nav__link">
    Bloodhound
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-tools-for-active-directory-environments" class="md-nav__link">
    Other tools for Active Directory environments
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ad-attack-paths_1" class="md-nav__link">
    AD Attack paths
  </a>
  
    <nav class="md-nav" aria-label="AD Attack paths">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#certified-pre-owned" class="md-nav__link">
    Certified Pre-Owned
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#demo-video" class="md-nav__link">
    Demo video
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relaying" class="md-nav__link">
    Relaying
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#appendix-ad-defense-guidance" class="md-nav__link">
    APPENDIX - AD Defense guidance
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#appendix-kerberos-delegation-abuses" class="md-nav__link">
    APPENDIX - Kerberos Delegation Abuses
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="ad-attack-paths">AD Attack Paths</h1>
<h2 id="lateral-movement">Lateral Movement</h2>
<ul>
<li><a href="https://posts.specterops.io/offensive-lateral-movement-1744ae62b14f#:~:text=Lateral%20movement%20is%20the%20process%20of%20moving%20from%20one%20compromised,which%20would%20return%20a%20beacon.">Offensive Lateral Movement</a> The difficulty with lateral movement is doing it with good operational security (OpSec) which means generating the least amount of logs as possible, or generating logs that look normal. The purpose of this blog post is to not only <em>show the techniques</em>, but to <em>show what is happening under the hood</em> and any high-level indicators associated with them.</li>
<li>
<p><a href="https://posts.specterops.io/kerberosity-killed-the-domain-an-offensive-kerberos-overview-eb04b1402c61">Kerberosity Killed the Domain: An Offensive Kerberos Overview</a> This article is intended to give an overview of how Kerberos works and some of the more common attacks associated with it.</p>
<ul>
<li>Roasting</li>
<li>Silver Ticket</li>
<li>Golden Ticket</li>
<li>Delegation attacks (out of scope)</li>
</ul>
</li>
<li>
<p><a href="https://www.akamai.com/blog/security-research/linux-lateral-movement-more-than-ssh#file-transfer">The L in Linux Stands for Lateral Movement</a> Only one protocol comes to mind — SSH. In this blog post, we’ll look at other protocols in Linux that can be used to achieve (or to help achieve) lateral movement.</p>
</li>
<li><a href="https://learn.microsoft.com/en-us/windows-server/identity/securing-privileged-access/reference-tools-logon-types">Administrative tools and logon types</a> A nightmare of variant and details. Practically important for understanding which network operations leave credentials in memory of the remote node.</li>
</ul>
<h2 id="discovery">Discovery</h2>
<p>The <a href="https://attack.mitre.org/tactics/TA0007/">Discovery Tactic</a> is almost always used in conjunction with Lateral Movement.</p>
<p>Discovery is often called <em>enumeration</em>.</p>
<h3 id="tools-for-windows-machines">Tools for Windows machines</h3>
<ul>
<li><a href="https://juggernaut-sec.com/manual-enumeration/">Manual Enumeration – Juggernaut Pentesting Academy</a> Basic commands for user enumeration, system enumeration, software enumeration, network enumeration, anti-virus and firewall enumeration.</li>
</ul>
<h3 id="bloodhound">Bloodhound</h3>
<p>"The" Discovery tool for Windows Active Directory: a game changer.</p>
<ul>
<li><a href="https://www.youtube.com/watch?v=z8thoG7gPd0">Here Be Dragons The Unexplored Land of Active Directory ACLs</a> The original 45-minutes video at DerbyCon 2017 that introduced this tool.</li>
<li><a href="https://www.sans.org/blog/bloodhound-sniffing-out-path-through-windows-domains/">BloodHound – Sniffing Out the Path Through Windows Domains</a> One of the many tutorials available.</li>
<li><a href="https://bloodhound.readthedocs.io/en/latest/index.html">BloodHound: Six Degrees of Domain Admin</a> The official site.</li>
</ul>
<p>BloodHound-related tools;</p>
<ul>
<li><a href="https://blog.bitsadmin.com/blog/dealing-with-large-bloodhound-datasets">Dealing with large BloodHound datasets</a>. Discusses other tools similar to BloodHound, including <a href="https://www.youtube.com/watch?app=desktop&amp;v=76MWt8uugAg">BlueHound</a>.</li>
<li>
<p><a href="https://github.com/zeronetworks/BloodHound-Tools">BloodHound tools</a>.</p>
<ul>
<li><em>ShotHound</em>: Validate practical paths discovered by BloodHound.</li>
<li><em>Ransomulator</em>: Simulate ransomware-like infection in your dataset.</li>
<li><em>DBCreator</em>: Simulate BloodHound dataset, along with "Open" network access edges and unpatched vulnerabilities information.</li>
<li><em>CustomQueries</em>: A list of common queries that reflect the network dimension, if it is integrated into the dataset.</li>
<li><em>VulnerabilitiesDataImport</em>:
Parse Vulnerability Scanners reports and enrich host nodes with information about unpatched vulnerabilities</li>
</ul>
</li>
<li>
<p><a href="https://assurancemaladiesec.github.io/foxterrier-on-the-trail/">FoxTerrier : On the trail of vulnerable Active Directory objects and a report</a>. You use Sharphound/Bloodhound to collect data/audit your AD and you would like to generate report of vulnerable objects in your AD? You should give a look to FoxTerrier!</p>
</li>
</ul>
<p>BloodHound-like tools:</p>
<ul>
<li><a href="https://zeronetworks.com/blog/bluehound-community-driven-resilience/">BlueHound</a> Very similar to BloodHound. It collects metrics similar to some of those available only in the paid version of BloodHound.</li>
<li><a href="https://github.com/lkarlslund/Adalanche">Adalanche</a> </li>
<li><a href="https://labs.lares.com/introducing-slinkycat/">Introducing Slinky Cat - Living off the AD Land</a> Help security and IT teams reduce their AD exposures and uncover quick wins and fixes designed for pen-testers and defenders alike.</li>
</ul>
<h3 id="other-tools-for-active-directory-environments">Other tools for Active Directory environments</h3>
<ul>
<li><a href="https://www.politoinc.com/post/ldap-queries-for-offensive-and-defensive-operations">LDAP Queries for Offensive and Defensive Operations</a> Basic queries for targeted Active Directory information gathering used in penetration testing (“low and slow” approach without BloodHound).</li>
<li><a href="https://infosecwriteups.com/user-enumeration-techniques-and-tactics-in-an-active-directory-pentesting-engagement-c634bf241017">User Enumeration Techniques and Tactics In an Active Directory Pentesting Engagement</a> A blog post describing several techniques for finding valid accounts in Active Directory.</li>
<li><a href="https://github.com/SnaffCon/Snaffler?ref=labs.lares.com">Snaffler</a> it takes a list of Windows computers from Active Directory as input; it figures out which ones have file shares, and whether you can read them. It also enumerates the files in these shares and searches passwords (that should not be stored there) with some heuristics.</li>
<li><a href="https://labs.lares.com/introducing-scraping-kit/">Scraping kit</a> Tools for scraping services, domain controllers, Outlook email client based on a provided list of keywords.</li>
<li><a href="https://adsecurity.org/?p=4115">There’s Something About Service Accounts Discover (SPN scanning)</a> Without port scanning.</li>
</ul>
<h2 id="ad-attack-paths_1">AD Attack paths</h2>
<p>This is a huge topic.</p>
<ul>
<li><a href="https://labs.lares.com/securing-active-directory-via-acls/">The Phantom Menace: Exposing hidden risks through ACLs in Active Directory (Part 1)</a> An excellent and concise description of ACLs in Active Directory (starting from what a Securable Object is) from an offensive point of view.</li>
<li>
<p><a href="https://bloodhound.readthedocs.io/en/latest/data-analysis/edges.html">BloodHound Edges</a> Perhaps the best way for understanding the breadth and depth of AD Attack paths is looking at how many edge types exist in BloodHound. This page is very interesting because it describes how the edge could be abused, the associated technical difficulty and some operational security (OpSec) consideration.</p>
</li>
<li>
<p><a href="https://swisskyrepo.github.io/InternalAllTheThings/">Internal All The Things</a>
Active Directory and Internal Pentest Cheatsheets. Lots of useful step-by-step examples.</p>
</li>
<li><a href="https://zer1t0.gitlab.io/posts/attacking_ad/">Attacking Active Directory: 0 to 0.</a> Nice description of many Windows topics, including Active Directory, Access Rights and so on.</li>
</ul>
<h3 id="certified-pre-owned">Certified Pre-Owned</h3>
<p>This is just one of the many families of AD Attack Paths.</p>
<ul>
<li><a href="https://www.mandiant.com/resources/blog/tracking-apt29-phishing-campaigns">Trello From the Other Side: Tracking APT29 Phishing Campaigns</a> APT29 is a Russian espionage group. Very interesting and detailed analysis of a phishing campaigns targeting diplomatic organizations in Europe, the Americas, and Asia. Based on <em>misconfigured certificate templates</em>.</li>
<li>
<p><a href="https://www.youtube.com/watch?v=8OtfW4uo75k">Exploiting Outlook CVE-2023-23397 to Relay Credentials</a> Based on a coerced authentication vulnerability of Outlook. It uses PKINIT and credential relay. <em>"I exploit Outlook to relay credentials to NTLMrelayx, get a certificate of a domain admin, and fully take over a domain. It only takes a meeting invite and a user simply opening outlook to exploit this vulnerability."</em> Nice and focussed video.</p>
</li>
<li>
<p><a href="https://posts.specterops.io/certified-pre-owned-d95910965cd2">Certified Pre-Owned</a> By those that discovered this path. Abusing Actice Directory Certificate Services (8 insecure certificate templates). Accompanied by a +140-pages report including some prevention and detection guidance.</p>
</li>
<li><a href="https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/adcs-+-petitpotam-ntlm-relay-obtaining-krbtgt-hash-with-domain-controller-machine-certificate">ADCS + PetitPotam NTLM Relay: Obtaining krbtgt Hash with Domain Controller Machine Certificate</a> This is a quick lab to familiarize with an Active Directory Certificate Services (ADCS) + NLTM Relay. Step-by-step examples and screenshots.</li>
<li><a href="https://vandanpathak.com/exploiting-ad/adcs-attacking-part-1/">Attacking AD Certificate Services – Part 1</a> Another of the many step-by-step tutorials in this area.</li>
<li><a href="https://posts.specterops.io/shadow-credentials-abusing-key-trust-account-mapping-for-takeover-8ee1a53566ab">Shadow Credentials: Abusing Key Trust Account Mapping for Account Takeover</a> Very interesting attack path based on PKINIT, with considerations on detection and prevention. Not very easy.</li>
</ul>
<h3 id="demo-video">Demo video</h3>
<p>Demo of four different AD attack paths, with considerations about their OPSEC (i.e., ability to remain undetected). <a href="https://conference.hitb.org/hitbsecconf2023ams/materials/D2T2%20-%20Active%20Directory%20Abuse%20Primitive%20and%20Operation%20Security%20-%20Mars%20Cheng.pdf">Slides</a> and <a href="https://www.youtube.com/watch?v=CIkSiECswYw">one hour video</a>.</p>
<ol>
<li>Kerberoasting, Pass the ticket, Dump ticket from Logon session and other</li>
<li>Certificate Template Abuse, PKINIT authentication, Unconstrained delegation (this step out of scope), DCSync that is domain controller replication</li>
<li>Password spray, Overprivilege + Shadow credential, UnPAC the hash + Silver Ticket, Golden Ticket</li>
<li>Coerced authentication, NTLM Relay + Shadow credentials, DCSync + Diamond Ticket, SID-history infection (last steps out of scope)</li>
</ol>
<h3 id="relaying">Relaying</h3>
<ul>
<li><a href="https://www.secureauth.com/blog/we-love-relaying-credentials-a-technical-guide-to-relaying-credentials-everywhere/">A guide to relaying credentials everywhere in 2022</a> Including Shadow Credentials and Certificate Services (ADCS)</li>
<li><a href="https://www.praetorian.com/blog/how-to-exploit-active-directory-acl-attack-paths-through-ldap-relaying-attacks/">How to Exploit Active Directory ACL Attack Paths Through LDAP Relaying Attacks</a></li>
</ul>
<h2 id="appendix-ad-defense-guidance">APPENDIX - AD Defense guidance</h2>
<p>In my modest opinion, a lost battle.</p>
<p>Look for example at the blog post presenting the <a href="https://www.microsoft.com/en-us/security/business/microsoft-digital-defense-report-2022-cyber-resilience">Microsoft Digital Defense Report 2022</a>: "<em>This chart shows the percentage of impacted customers missing basic security controls which are critical to increasing organizational cyber resilience. Findings are based on Microsoft engagements over the past year.</em>".  You will see that 90% of customers have an insecure AD configuration, 98% of customers do not use a tiered model, and the like. To me, this means that defending AD is a losing battle from the start.</p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/plan/security-best-practices/best-practices-for-securing-active-directory">Best Practices for Securing Active Directory</a> from Microsoft Learn.</li>
<li><a href="https://www.hub.trimarcsecurity.com/post/ten-ways-to-improve-ad-security-quickly">Top 10 ways of securing AD</a>. List of most common misconfigurations that can be exploited and how to fix them. </li>
<li><a href="https://techcommunity.microsoft.com/t5/microsoft-security-experts-blog/total-identity-compromise-microsoft-incident-response-lessons-on/ba-p/3753391">Total Identity Compromise: Microsoft Incident Response lessons on securing Active Directory</a> Across all industry verticals, Microsoft Incident Response often finds similar issues within Active Directory environments. In this blog, we will be highlighting some of the most common issues seen in on-premises Active Directory environments and provide guidance on how to secure those weaknesses.</li>
</ul>
<p>Tools for checking common AD misconfigurations and obtain synthetic reports.</p>
<ul>
<li><a href="https://www.pingcastle.com/">PingCastle</a> </li>
<li><a href="https://www.hub.trimarcsecurity.com/post/securing-active-directory-performing-an-active-directory-security-review">Trimarc ADChecks</a> </li>
<li><a href="https://www.cert.ssi.gouv.fr/uploads/ad_checklist.html">Checklist</a> A self-assessment checklist by CERT France.</li>
</ul>
<h2 id="appendix-kerberos-delegation-abuses">APPENDIX - Kerberos Delegation Abuses</h2>
<p>Out of scope (but very, very interesting...)</p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/archive/msdn-magazine/2003/april/exploring-s4u-kerberos-extensions-in-windows-server-2003">Exploring S4U Kerberos Extensions in Windows Server 2003</a> Microsoft explanation of S4U.</li>
<li><a href="https://www.linkedin.com/posts/mor-davidovich-57641614a_krbrelayup-rbcd-lpe-activity-7071418645842731008-c2wD/?originalSubdomain=qa">Krbrelayup</a> A 30-sec video showing usage of the DavRelayUp tool.</li>
<li><a href="https://www.microsoft.com/en-us/security/blog/2022/05/25/detecting-and-preventing-privilege-escalation-attacks-leveraging-kerberos-relaying-krbrelayup/">Detecting and preventing privilege escalation attacks leveraging Kerberos relaying (KrbRelayUp)</a> Description and recommendations by Microsoft.</li>
<li><a href="https://posts.specterops.io/kerberosity-killed-the-domain-an-offensive-kerberos-overview-eb04b1402c61">Kerberosity Killed the Domain: An Offensive Kerberos Overview</a> Kerberos delegation attacks.</li>
</ul>


  




                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["search.suggest", "search.highlight", "navigation.instant", "navigation.tracking"], "search": "../../assets/javascripts/workers/search.dfff1995.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.78eede0e.min.js"></script>
      
    
  </body>
</html>