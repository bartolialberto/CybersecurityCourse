
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://bartolialberto.github.io/CybersecurityCourse/Labs/OWASP%20Juice%20Shop/">
      
      
        <link rel="prev" href="../MITRE_ATTACK_Navigator/">
      
      
        <link rel="next" href="../../docsify/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-9.2.5">
    
    
      
        <title>OWASP Juice Shop - Cybersecurity Course - University of Trieste</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.0e669242.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.85d0ee34.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-7FK5GG9NWX"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-7FK5GG9NWX",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-7FK5GG9NWX",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="orange" data-md-color-accent="indigo">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#owasp-juice-shop" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="https://bartoli.inginf.units.it" title="Cybersecurity Course - University of Trieste" class="md-header__button md-logo" aria-label="Cybersecurity Course - University of Trieste" data-md-component="logo">
      
  <img src="../../bernabeu small.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Cybersecurity Course - University of Trieste
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              OWASP Juice Shop
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://bartoli.inginf.units.it" title="Cybersecurity Course - University of Trieste" class="md-nav__button md-logo" aria-label="Cybersecurity Course - University of Trieste" data-md-component="logo">
      
  <img src="../../bernabeu small.png" alt="logo">

    </a>
    Cybersecurity Course - University of Trieste
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../Topics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Topics
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    1 - Hacking Lab
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            1 - Hacking Lab
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Hacking%20Lab/Lab_Hacking_Metasploitable/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metasploitable3 Hacking Lab
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Hacking%20Lab/Lab_Virtual_Machines/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metasploitable3 Hacking Lab - Installation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Hacking%20Lab/Vulnerable%20Platforms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vulnerable Platforms
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    2 - Access Control
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            2 - Access Control
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Access%20Control/Resources%20-%20Access%20Control/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Access Control - Resources
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    3 - MITRE ATT&CK
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            3 - MITRE ATT&CK
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../MITRE%20ATTACK/ATTACK%20-%20MITRE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MITRE ATT&CK
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../MITRE%20ATTACK/ICS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ICS - Industrial Control Systems
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    4 - Malware
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            4 - Malware
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Malware/Execution%20and%20other%20tactics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Execution and Other Tactics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Malware/Initial%20Access%20Advanced/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Initial Access - Advanced Techniques
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Malware/Initial%20Access/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Initial Access
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Malware/Malware%20detection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Malware detection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Malware/Malware_Case_Studies/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intrusions and Malware - Case studies
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    5 - Passwords
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            5 - Passwords
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Passwords/Passwords/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Passwords
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    6 - Authentication - NTLM Kerberos
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            6 - Authentication - NTLM Kerberos
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Authentication%20-%20NTLM%20Kerberos/Authentication%20-%20Windows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authentication in Windows
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    7 - Lateral Movement and AD Abuse
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            7 - Lateral Movement and AD Abuse
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Lateral%20Movement%20and%20AD%20Abuse/AD_abuse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AD Abuse
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Lateral%20Movement%20and%20AD%20Abuse/Discovery/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Discovery
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Lateral%20Movement%20and%20AD%20Abuse/Lateral%20Movement/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lateral Movement
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    8 - MFA
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            8 - MFA
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../MFA/MFA/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multifactor Authentication (MFA)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    9 - Memory Corruption
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            9 - Memory Corruption
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Memory%20Corruption/Memory%20Corruption%20-%20Case%20studies/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Memory corruption - Case studies
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Memory%20Corruption/Resources%20-%20Memory%20corruption_/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Memory Corruption
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12" >
        
          <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    10 - Vulnerabilities
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12">
            <span class="md-nav__icon md-icon"></span>
            10 - Vulnerabilities
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Vulnerabilities/Resources%20-%20Vulnerabilities%20Intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vulnerabilities Introduction - Resources
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Vulnerabilities/Resources%20-%20Vulnerability%20Management/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vulnerability Management - Resources
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Vulnerabilities/Vulnerability%20-%20Case%20studies/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vulnerabilities - Case Studies
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13" >
        
          <label class="md-nav__link" for="__nav_13" id="__nav_13_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    11 - Defense
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_13">
            <span class="md-nav__icon md-icon"></span>
            11 - Defense
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../Defense/Defense%20-%20Resources/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Defense - Resources
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_14" checked>
        
          <label class="md-nav__link" for="__nav_14" id="__nav_14_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Labs
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_14_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_14">
            <span class="md-nav__icon md-icon"></span>
            Labs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Automated%20Malware%20Analysis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Automated Malware Analysis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../BURP/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BURP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../MITRE_ATTACK_Navigator/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MITRE ATT&CK NAVIGATOR.
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    OWASP Juice Shop
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    OWASP Juice Shop
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#owasp-juice-shop" class="md-nav__link">
    OWASP Juice Shop
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources" class="md-nav__link">
    Resources
  </a>
  
    <nav class="md-nav" aria-label="Resources">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#general-descriptions" class="md-nav__link">
    General descriptions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#writeups" class="md-nav__link">
    Writeups
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#technical-notes" class="md-nav__link">
    Technical notes
  </a>
  
    <nav class="md-nav" aria-label="Technical notes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#authentication-in-owasp-juice-shop" class="md-nav__link">
    Authentication in OWASP Juice Shop
  </a>
  
    <nav class="md-nav" aria-label="Authentication in OWASP Juice Shop">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bearer-tokens-explained" class="md-nav__link">
    Bearer Tokens Explained
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bearer-tokens-in-owasp-juice-shop" class="md-nav__link">
    Bearer Tokens in OWASP Juice Shop
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-traffic" class="md-nav__link">
    Example traffic
  </a>
  
    <nav class="md-nav" aria-label="Example traffic">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#login" class="md-nav__link">
    Login
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shopping-basket" class="md-nav__link">
    Shopping Basket
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bearer-token-in-decoded-form" class="md-nav__link">
    Bearer token in decoded form
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#idor-vulnerability" class="md-nav__link">
    IDOR vulnerability
  </a>
  
    <nav class="md-nav" aria-label="IDOR vulnerability">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#detecting-the-vulnerability" class="md-nav__link">
    Detecting the vulnerability
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exploiting-the-vulnerability" class="md-nav__link">
    Exploiting the vulnerability
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#another-idor-vulnerability" class="md-nav__link">
    Another IDOR vulnerability
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-few-further-simple-vulnerabilities" class="md-nav__link">
    A few further simple vulnerabilities
  </a>
  
    <nav class="md-nav" aria-label="A few further simple vulnerabilities">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#online-password-guessing" class="md-nav__link">
    Online password guessing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sql-injection-in-login-page" class="md-nav__link">
    SQL Injection in login page
  </a>
  
    <nav class="md-nav" aria-label="SQL Injection in login page">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sql-injection-explained" class="md-nav__link">
    SQL Injection explained
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#more-sql-injection-in-login-page" class="md-nav__link">
    More SQL Injection in login page
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../docsify/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Report (Docsify-This)
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#owasp-juice-shop" class="md-nav__link">
    OWASP Juice Shop
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources" class="md-nav__link">
    Resources
  </a>
  
    <nav class="md-nav" aria-label="Resources">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#general-descriptions" class="md-nav__link">
    General descriptions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#writeups" class="md-nav__link">
    Writeups
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#technical-notes" class="md-nav__link">
    Technical notes
  </a>
  
    <nav class="md-nav" aria-label="Technical notes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#authentication-in-owasp-juice-shop" class="md-nav__link">
    Authentication in OWASP Juice Shop
  </a>
  
    <nav class="md-nav" aria-label="Authentication in OWASP Juice Shop">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bearer-tokens-explained" class="md-nav__link">
    Bearer Tokens Explained
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bearer-tokens-in-owasp-juice-shop" class="md-nav__link">
    Bearer Tokens in OWASP Juice Shop
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-traffic" class="md-nav__link">
    Example traffic
  </a>
  
    <nav class="md-nav" aria-label="Example traffic">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#login" class="md-nav__link">
    Login
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shopping-basket" class="md-nav__link">
    Shopping Basket
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bearer-token-in-decoded-form" class="md-nav__link">
    Bearer token in decoded form
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#idor-vulnerability" class="md-nav__link">
    IDOR vulnerability
  </a>
  
    <nav class="md-nav" aria-label="IDOR vulnerability">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#detecting-the-vulnerability" class="md-nav__link">
    Detecting the vulnerability
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exploiting-the-vulnerability" class="md-nav__link">
    Exploiting the vulnerability
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#another-idor-vulnerability" class="md-nav__link">
    Another IDOR vulnerability
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-few-further-simple-vulnerabilities" class="md-nav__link">
    A few further simple vulnerabilities
  </a>
  
    <nav class="md-nav" aria-label="A few further simple vulnerabilities">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#online-password-guessing" class="md-nav__link">
    Online password guessing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sql-injection-in-login-page" class="md-nav__link">
    SQL Injection in login page
  </a>
  
    <nav class="md-nav" aria-label="SQL Injection in login page">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sql-injection-explained" class="md-nav__link">
    SQL Injection explained
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#more-sql-injection-in-login-page" class="md-nav__link">
    More SQL Injection in login page
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>OWASP Juice Shop</h1>

<h2 id="owasp-juice-shop">OWASP Juice Shop</h2>
<p>It is a web application that has been developed by the OWASP consortium for <strong>practicing web application security testing</strong>. It ontains many vulnerabilities of different nature. It also contains detection code that displays a “vulnerability found” banner whenever it detects that the user has managed to exploit one of the numerous vulnerabilities of the webapp.</p>
<p>OWASP has made the sources available and the webapp itself has to be installed and deployed on a web server in order to be actually used. An almost one-click and free deployment on a cloud platform can be obtained quite easily (see “Resources” below).</p>
<h2 id="resources">Resources</h2>
<p>Many videos and tutorials are available on the web that describe this webapp. Keep in mind that these resources:</p>
<ul>
<li>Do not describe the internal architecture of the webapp.</li>
<li>Assume some basic knowledge of web application security.</li>
<li>Do not provide a full step-by-step guide for detecting all the vulnerabilities of the webapp.</li>
<li>Have an extremely (excessive) practical orientation: the focus is not “understand what you are doing”; it is “let the application display the “vulnerability found” banner”.</li>
</ul>
<h3 id="general-descriptions">General descriptions</h3>
<ul>
<li><a href="https://pwning.owasp-juice.shop/">Official companion of the OWASP Juice Shop webapp</a> General overview of the webapp.</li>
<li><a href="https://pwning.owasp-juice.shop/part2/">List of vulnerabilities</a> along with their difficulty and hints about how to discover them.</li>
<li><a href="https://pwning.owasp-juice.shop/appendix/solutions.html">Detailed solutions</a></li>
<li><a href="https://pwning.owasp-juice.shop/part1/running.html">Instructions for running the webapp</a> <ul>
<li>One-click deployment on the free cloud platform Heroku. If you do so, remember to deactivate the webapp on Heroku while it is not used, in order to not use Heroku resources unnecessarily (Resources section of your Heroku account; just stop the corresponding “Dyno”)</li>
<li><strong>UPDATE DECEMBER 2022</strong>: Heroku is no longer free but requires a small subscription fee. <strong>Gitpod</strong> provides the same functionality of one-click deployment with a free tier that is renewed each month automatically. Follow the instructions above; remember to “stop” the workspace while not in use (to not consume your credits) and to “pin” the workspace (otherwise it will be deleted after 30 days of inactivity).</li>
</ul>
</li>
</ul>
<h3 id="writeups">Writeups</h3>
<p>Blog posts listing <strong>solutions to some of the challenges</strong> (vulnerabilities found):</p>
<ul>
<li><a href="https://neophytise.wordpress.com/2020/06/27/tryhackme-owasp-juice-shop-walkthrough/">Tryhackme - OWASP Juice Shop walkthrough</a></li>
<li><a href="https://hacklido.com/blog/246-tryhackme-owasp-juice-shop-detailed-writeup">Tryhackme - OWASP Juice Shop walkthrough (2)</a></li>
<li><a href="https://ex0a.medium.com/tryhackme-owasp-juice-shop-53e87fb1af36">Tryhackme - OWASP Juice Shop walkthrough (3)</a></li>
</ul>
<h2 id="technical-notes">Technical notes</h2>
<h3 id="authentication-in-owasp-juice-shop">Authentication in OWASP Juice Shop</h3>
<h4 id="bearer-tokens-explained">Bearer Tokens Explained</h4>
<p>Authentication in the OWASP Juice Shop webapp is managed differently from how we described it in “Computer Networks 1” and is based on <strong>JSON Web Tokens</strong>. This is a widely used mechanism specified by a  web standard called OAuth and briefly summarized below.</p>
<p>Web sessions are associated with cookies. In principle, once a session is authenticated (i.e., a correct username-password pair has been provided in the login form), the cookie identifier should suffice to prove the identity of the user. That is, a webapp that receives a request determines the identity of the sending user based on the value of the <code>Cookie</code>header, by using this value as a key for accessing a table stored in the webapp that contains the full session state including the username. Many webapps implement authentication based on cookies.</p>
<p>Many other webapps encode instead the authentication information in an <em>additional</em> header called <code>Authorization</code>, whose value is <code>Bearer</code>followed by a <em>bearer token</em>.</p>
<p>A bearer token is a “very long string” constructed by a webapp upon receiving a successful login request. The content of this string is not meaningful to clients. Whenever the webapp receives an HTTP request, it determines the identity of the user from the web token in the <code>Authorization</code>header, rather than from the value of the <code>Cookie</code>header. The validity time interval of a bearer token is independent of the lifetime of the HTTP session, thus of the cookie.</p>
<p>Of course, bearer tokens must be managed so that users cannot forge or modify them arbitrarily (i.e., bearer tokens must have authenticity and integrity; and, the webapp must be able to verify these security properties of each received bearer token).</p>
<p>Based on this description, one might think of bearer tokens as just cookies sent with a different header. There are actually many deep but complex differences between the two mechanisms that are beyond the scope of this document.</p>
<h4 id="bearer-tokens-in-owasp-juice-shop">Bearer Tokens in OWASP Juice Shop</h4>
<p>The OWASP Juice Shop webapp uses bearer tokens for authentication. However, this use does not follow the OAuth specification completely  and is insecure. In detail:</p>
<ol>
<li>Data inserted in the login form are not sent with the standard HTML mechanism, i.e., as an entity that consists of query string encoded as <code>Content-Type: x-www-form-urlencoded</code>; the entity consists instead of JSON data (<code>Content-Type: application/json</code>). This is managed by Javascript code in the browser, i.e., clicking on the form button results in invoking some Javascript code; this code will collect the user-provided data, assemble it in a JSON entity and send this entity to the webapp.</li>
<li>Bearer tokens are returned in the response to the request containing the credentials inserted in the login form (rather than with a standard, more complex OAuth flow).</li>
<li>Bearer tokens contain the username of the token owner and the corresponding password hash.</li>
</ol>
<p>Regarding point 2, there is no reason whatsoever for including username and password hash in the token. At first glance, this might not seem a risk: the token for a user will be visible only to that user, because the traffic is on HTTPS and the bearer token is only sent in response to a login form.</p>
<p>However, if the webapp had a vulnerability allowing a user A to login as user B, then user A would access the bearer token for user B. Thus, user A would obtain the password hash for user B and would thus be able to impersonate user B forever.</p>
<p>As it turns out, OWASP Juice Shop has this vulnerability (see Question #1 <a href="https://hacklido.com/blog/246-tryhackme-owasp-juice-shop-detailed-writeup">here</a>): A can login as B (because of this vulnerability) and thus A can impersonate B forever (because of the insecure implementation of bearer tokens).</p>
<h4 id="example-traffic">Example traffic</h4>
<h5 id="login">Login</h5>
<p>Credentials are sent as a JSON resource in the request. The response contains a bearer token.</p>
<p><strong><em>*Request</em></strong>*</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>POST /rest/user/login HTTP/1.1
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>Host: owasp-juice-shop-alberto.herokuapp.com
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>Cookie: language=en; welcomebanner_status=dismiss; cookieconsent_status=dismiss; continueCode=KQabVVENkBvjq9O2xgyoWrXb45wGnmTxdaL8m1pzYlPQKJMZ6D37neRqyn3x
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>...
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>Content-Type: application/json
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>...
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>{&quot;email&quot;:&quot;1@1.com&quot;,&quot;password&quot;:&quot;11111&quot;}
</span></code></pre></div>
<p><strong>Response</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>HTTP/1.1 200 OK
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>...
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>Content-Type: application/json; charset=utf-8
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>Content-Length: 808
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>Etag: W/&quot;328-+1bdmcgdtIFfafMn3oEmj38Axmo&quot;
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>...
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>{
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>&quot;Authentication&quot;:
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>    {&quot;token&quot;:
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>    &quot;eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJzdGF0dXMiOiJzdWNjZXNzIiwiZGF0YSI6eyJpZCI6MjEsInVzZXJuYW1lIjoiIiwiZW1haWwiOiIxQDEuY29tIiwicGFzc3dvcmQiOiJiMGJhZWU5ZDI3OWQzNGZhMWRmZDcxYWFkYjkwOGMzZiIsInJvbGUiOiJjdXN0b21lciIsImRlbHV4ZVRva2VuIjoiIiwibGFzdExvZ2luSXAiOiIwLjAuMC4wIiwicHJvZmlsZUltYWdlIjoiL2Fzc2V0cy9wdWJsaWMvaW1hZ2VzL3VwbG9hZHMvZGVmYXVsdC5zdmciLCJ0b3RwU2VjcmV0IjoiIiwiaXNBY3RpdmUiOnRydWUsImNyZWF0ZWRBdCI6IjIwMjEtMDgtMjkgMTc6NDE6MDIuNTY2ICswMDowMCIsInVwZGF0ZWRBdCI6IjIwMjEtMDgtMjkgMTc6NDE6MDIuNTY2ICswMDowMCIsImRlbGV0ZWRBdCI6bnVsbH0sImlhdCI6MTYzMDI1ODg3MiwiZXhwIjoxNjMwMjc2ODcyfQ.vMIu5yD-VJux8FspwslykpET009gEYsIoYhb1azL62dIoeRIYFd2AX8wR6_RJrXDPgluwB9ra0QO2Wk9GA5LhadfCkfxxXB-Kgb7XjXzIWo6sxqDfAjza_Yt8mUevv3yIU84RHHpxDFFn0jtZnIAY90ZE5gmxvChOWIwWvLg3XA&quot;,
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>    &quot;bid&quot;:6,
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>    &quot;umail&quot;:&quot;[1@1.com](mailto:1@1.com)&quot;
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>    }
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a>}
</span></code></pre></div>
<h5 id="shopping-basket">Shopping Basket</h5>
<p>The request carries a cookie and a bearer token (encoded in a certain format). The response contains the corresponding shopping basket described in JSON.</p>
<p><strong>Request</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>GET /rest/basket/6 HTTP/1.1
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>Host: owasp-juice-shop-alberto.herokuapp.com
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>Cookie: language=en; welcomebanner_status=dismiss; cookieconsent_status=dismiss; continueCode=KQabVVENkBvjq9O2xgyoWrXb45wGnmTxdaL8m1pzYlPQKJMZ6D37neRqyn3x; ...
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>Accept: application/json, text/plain, */*
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJzdGF0dXMiOiJzdWNjZXNzIiwiZGF0YSI6eyJpZCI6MjEsInVzZXJuYW1lIjoiIiwiZW1haWwiOiIxQDEuY29tIiwicGFzc3dvcmQiOiJiMGJhZWU5ZDI3OWQzNGZhMWRmZDcxYWFkYjkwOGMzZiIsInJvbGUiOiJjdXN0b21lciIsImRlbHV4ZVRva2VuIjoiIiwibGFzdExvZ2luSXAiOiIwLjAuMC4wIiwicHJvZmlsZUltYWdlIjoiL2Fzc2V0cy9wdWJsaWMvaW1hZ2VzL3VwbG9hZHMvZGVmYXVsdC5zdmciLCJ0b3RwU2VjcmV0IjoiIiwiaXNBY3RpdmUiOnRydWUsImNyZWF0ZWRBdCI6IjIwMjEtMDgtMjkgMTc6NDE6MDIuNTY2ICswMDowMCIsInVwZGF0ZWRBdCI6IjIwMjEtMDgtMjkgMTc6NDE6MDIuNTY2ICswMDowMCIsImRlbGV0ZWRBdCI6bnVsbH0sImlhdCI6MTYzMDI1ODg3MiwiZXhwIjoxNjMwMjc2ODcyfQ.vMIu5yD-VJux8FspwslykpET009gEYsIoYhb1azL62dIoeRIYFd2AX8wR6_RJrXDPgluwB9ra0QO2Wk9GA5LhadfCkfxxXB-Kgb7XjXzIWo6sxqDfAjza_Yt8mUevv3yIU84RHHpxDFFn0jtZnIAY90ZE5gmxvChOWIwWvLg3XA
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>...
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>Accept-Language: en-US,en;q=0.9
</span></code></pre></div>
<p><strong>Response</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>HTTP/1.1 200 OK
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>...
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>Content-Type: application/json; charset=utf-8
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>Content-Length: 154
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>Etag: W/&quot;9a-1IBRCZ5Q9/JL7raf23dCq8reO7A&quot;
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>...
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>{
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>    &quot;status&quot;:&quot;success&quot;,
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>    &quot;data&quot;:
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>    {
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a>    &quot;id&quot;:6,
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>    &quot;coupon&quot;:null,
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a>    &quot;createdAt&quot;:&quot;2021-08-29T17:41:11.950Z&quot;
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a>    &quot;updatedAt&quot;:&quot;2021-08-29T17:41:11.950Z&quot;
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a>    &quot;UserId&quot;:21,
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a>    &quot;Products&quot;:[]
</span><span id="__span-3-18"><a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a>    }
</span><span id="__span-3-19"><a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a>}
</span></code></pre></div>
<h5 id="bearer-token-in-decoded-form">Bearer token in decoded form</h5>
<p>By copying the above bearer token on the decoding facility on <a href="https://jwt.io/">https://jwt.io/</a> we obtain the JSON Web Token in decoded form as indicated below. Note the hash of the user password.</p>
<p><img alt="8ff0491e41575238670558d2fac6c385.png" src="../../_resources/8ff0491e41575238670558d2fac6c385-1.png" /></p>
<h3 id="idor-vulnerability">IDOR vulnerability</h3>
<p>The description of IDOR (Insecure Direct Object Reference) vulnerabilities is beyond the scope of this document. Many documents can be found on the web.  A simple and quick introduction can be found <a href="https://portswigger.net/web-security/access-control/idor">here</a>. Some real world examples:</p>
<ul>
<li><a href="https://blog.roysolberg.com/2018/07/airline-flights-leak">"I know what you did last summer - and also what you will be doing this one" 8 Jul. 2018</a>.</li>
<li><a href="https://www.tgcom24.mediaset.it/skuola/uno-studente-riesce-ad-hackerare-il-sito-di-18app-poi-decide-di-collaborare_3043772-201602a.shtml">"Uno studente riesce ad hackerare il sito di 18app, poi decide di collaborare" 28 Nov. 2016</a></li>
<li><a href="https://research.digitalinterruption.com/2020/09/10/giggle-laughable-security/">"Giggle; laughable security"  10 Sep 2020</a>.</li>
</ul>
<p>The OWASP Juice Shop webapp has an IDOR vulnerability: any authenticated user may read the shopping basket of any other user.</p>
<p>The target shopping basket is identified by a numerical identifier. The association of a specific username with a shopping basket identifier cannot be found by exploiting this vulnerability and it may or may not be possible. In other words, one might read shopping basket <code>8</code> but determining what is the username that owns this basket or what is the shopping basket of user <code>clay@cornell.edu</code> is a different problem.</p>
<h4 id="detecting-the-vulnerability">Detecting the vulnerability</h4>
<p>Essentially, the procedure is as follows:</p>
<ol>
<li>Create two users A and B.</li>
<li>Insert some items in the respective shopping baskets.</li>
<li>Identify the request sent by B for reading the shopping basket. Does the request contain a parameter that probably identifies B’s shopping basket?</li>
<li>Identify the request sent by A for reading the shopping basket. Modify the request with the parameter found at the previous step and send the request.</li>
<li>Can A see the shopping basket of B?</li>
</ol>
<p>This procedure can be executed in Burp easily:</p>
<ul>
<li>Set Intercept off.</li>
<li>Open an embedded browser and create two users, say A and B (Login→Not yet a customer).</li>
<li>Login as A and add some items to the shopping basket.</li>
<li>Inspect the HTTP history (Proxy→HTTP history) and identify the HTTP request that shows the shopping basket. It is a \
<code>GET</code> <code>/rest/basket/<em>small-integer-A</em></code> \
(e.g., <code>small-integer-A</code> might be 1 or 3 or something alike).</li>
<li>Logout and then login as B</li>
<li>Click on the shopping basket. Note that the shopping basket of B is empty.</li>
<li>Set Intercept on.</li>
<li>Reload the shopping basket</li>
<li>Forward each request one by one (Proxy→Intercept) until seeing \
<code>GET /rest/basket/<em>small-integer-B</em></code>.</li>
<li>Replace <code><em>small-integer-B</em></code> by <code><em>small-integer-A.</em></code></li>
<li>Forward this request and set Intercept off.</li>
<li>You will now see the shopping basket of A although you are logged as B.</li>
</ul>
<p>I emphasize that this is a mistake in the code of the webapp, i.e., a vulnerability: a user must not be able to see data private of another user.</p>
<p>The specific kind of this vulnerability belongs to the class described by the OWASP consortium as “Broken Access Control”. In the past, vulnerabilities in this class were categorized in two separate classes: “Insecure Direct Object Reference (IDOR)” and “Missing Function Access Control”.</p>
<h4 id="exploiting-the-vulnerability">Exploiting the vulnerability</h4>
<p>If an attacker wanted to exploit this vulnerability in a practical setting, the attacker would not know how many users are logged in and what the corresponding “small integer” values are. In such a setting, thus, the attacker would have to repeatedly send <code>GET /rest/basket/<em>small-integer-X</em></code>, with many different values for <code><em>small-integer-X</em></code>.  Essentially, the procedure is as follows:</p>
<ol>
<li>Login as A.</li>
<li>Identify the request for reading the shopping basket.</li>
<li>Instruct Burp to repeatedly send this request, specifying which part of the request to modify at each iteration and how.</li>
<li>A will see the shopping basket of the other users currently logged in.</li>
</ol>
<p>This operation can be done automatically in Burp with the <strong>Intruder</strong>module, as follows.</p>
<ul>
<li>Set intercept off</li>
<li>Login and click on the shopping basket.</li>
<li>Inspect the HTTP history (Proxy→HTTP history) and identify the HTTP request that shows the shopping basket.</li>
<li>Send this request to <strong>Intruder</strong>(right-click).</li>
<li>Go to the Intruder module of Burp. Select the Positions tab. A window will appear with the request just sent to this module.</li>
<li>Click “clear §” (this is because Intruder assumes by default that the iteration should be done on cookie values).</li>
<li>Specify which part of the request has to be modified at each iteration:</li>
<li>Select the small integer portion of the URL; replace it with any letter (e.g., ‘s’) and click  “add §”. At this point Intruder knows that it is this part of the request that has to be modified at each iteration (Figure Intruder 1).</li>
<li>Specify how to modify the specified part at each iteration:</li>
<li>Click on the Payloads tab and insert a set of integer values in the Payload options section (either by preparing a text file in advance or by inserting the values one by one; the professional version of Burp has more options in this respect)  (Figure Intruder 2).</li>
<li>Click “start attack”. At this point Intruder will repeatedly send the selected request to the webapp and will collect the corresponding responses. This traffic will <strong>not</strong>reach the browser. The traffic is shown in a new window and can be analyzed interactively  (Figure Intruder 3). Each message can be saved on a file.</li>
</ul>
<p><img alt="8660cc7f4b0a615aaee5712f3c490c84.png" src="../../_resources/8660cc7f4b0a615aaee5712f3c490c84-1.png" />
Figure Intruder 1: Request with portion to modified</p>
<p><img alt="9fdeebbdd4eb4809f74726c93c8800c8.png" src="../../_resources/9fdeebbdd4eb4809f74726c93c8800c8-1.png" />
Figure Intruder 2: Payload set configured as a list of integers</p>
<p><img alt="e792d1cde9d3d2018e0d94b7f51fa9b5.png" src="../../_resources/e792d1cde9d3d2018e0d94b7f51fa9b5-1.png" /></p>
<p>Figure Intruder 3: Part of the response for payload 5 (shopping basket of user id 16). In this execution, all the responses have returned a status code 200, thus corresponding to an existing shopping basket. Some of those baskets are empty.</p>
<h4 id="another-idor-vulnerability">Another IDOR vulnerability</h4>
<p>The IDOR vulnerability previously discussed allows any authenticated user to read the shopping basket of any other user. The web app has a <strong>further</strong> IDOR vulnerability: any authenticated user may <strong>modify</strong> the shopping basket of any other user. The same limitations previously discussed regarding the difference between shopping basket identifier and username apply to this vulnerability as well.</p>
<p>The steps for detecting and exploiting this vulnerability are very similar to those previously discussed, the only difference being this: rather than using the HTTP request that shows a shopping basket, one has to use the HTTP request that adds an item to a shopping basket. We omit the detailed steps for brevity.</p>
<p>The two IDOR vulnerabilities discussed here are associated with different URLs and requests, thus it is not possible to tell whether they are provoked by the same coding mistake or by two different mistakes in different portions of the web app code.</p>
<h3 id="a-few-further-simple-vulnerabilities">A few further simple vulnerabilities</h3>
<h4 id="online-password-guessing">Online password guessing</h4>
<p>The admin username is <code>admin@juice-sh.op</code> (this information can be found with another vulnerability, not discussed in this document for brevity). Online password guessing can be done against this username, as follows.  </p>
<ul>
<li>Search “<code>best1050.txt from Seclists</code>” on a search engine and download the corresponding text file (a list of 1050 frequently used passwords).</li>
<li>Set Intercept on</li>
<li>Attempt to login by inserting the username <a href="mailto:admin@juice-sh.op">admin@juice-sh.op</a> and any password.</li>
<li>Inspect the HTTP history and identify the HTTP request that sends the credentials (note that these are sent as a JSON resource rather than as a query string).</li>
<li>Send this request to Intruder (right-click).</li>
<li>Define the password as an Intruder parameter.</li>
<li>Click on the Payloads tab and load <code>best1050.txt</code> in the Payload options section.</li>
<li>Click “start attack”. At this point Intruder will repeatedly send the selected request to the webapp by changing the password at each iteration and will collect the corresponding responses. It will take some time to try all the passwords in the selected file.</li>
</ul>
<p>It can be seen in Figure Intruder 4 that the request number 117 obtained a status code 200, meaning that the correct password (admin123) was found.</p>
<p><img alt="1cd842992fa632a16765cad64ec42ae0.png" src="../../_resources/1cd842992fa632a16765cad64ec42ae0-1.png" />
Figure Intruder 4: Summary of the traffic sent by Intruder.</p>
<p>This vulnerability is not a mistake in the code. It is a configuration flaw.</p>
<h4 id="sql-injection-in-login-page">SQL Injection in login page</h4>
<ul>
<li>Open the login page.</li>
<li>Insert <code>' or 1=1--</code> as username (note the single quote character <code>'</code>at the very beginning of the username) and any string as password.</li>
</ul>
<p>The webapp will show a successful login and the username happens to be the administrator.</p>
<p>This vulnerability can be found and exploited even without using Burp. The reason is because:</p>
<ol>
<li>The string to be inserted in the username field is very simple: it is one of the basic SQL injection payloads that any pentester would try at the very beginning.</li>
<li>The Javascript code of the login page on the browser does not constrain or modify in any way the string inserted as username.</li>
</ol>
<p>In a real setting, usage of Burp would be advisable in order to try many SQL injection payloads and to detect whether the string inserted as username indeed corresponds to the string actually sent by the browser to the webapp.</p>
<h5 id="sql-injection-explained">SQL Injection explained</h5>
<p>Irrespective of the programming language used for developing the web app, the code that validates the received credentials on the web app must execute a SQL query on its database containing usernames and passwords. To this end, the code typically executes an IF-THEN-ELSE construct in which the IF condition is a boolean expression that must evaluate TRUE only when the username in the request is a valid username and the password in the request is a valid password.</p>
<p>Such an expression is often programmed in a form like this: \
<code>IF \
(SQL_QUERY(SELECT 'username-in-the-request' FROM … AND …)) \
THEN … ELSE ...</code></p>
<p>The part of the SQL query before the AND operator makes sure the username exists, the part after the AND (not shown for brevity) makes sure the provided password is indeed the password for that username.</p>
<p>The SQL semantics is such that if the SQL query returns an empty result set then it corresponds to the boolean FALSE, otherwise it corresponds to the boolean TRUE. Thus, the boolean expression will behave as expected.</p>
<p>The vulnerability (coding mistake) is when the web app code takes the data inserted in the HTTP request without any prior control or “sanitization”. Without such a control, carefully selected input strings (SQL injection payloads) might change the logical structure of the SQL query and provoke a behavior different from what expected by the developer of the web app.</p>
<p>As it turns out, the OWASP Juice Shop suffers from this vulnerability in the login page. The value <code>' or 1=1--</code>  for the username has the effect of changing the structure of the the SQL_QUERY:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>IF
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>(SQL_QUERY(SELECT &#39;&#39; or 1=1--&#39; FROM … AND …))
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>THEN … ELSE ...
</span></code></pre></div>
<p>The query actually executed by the SQL engine will be:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>SELECT &#39;&#39; or 1=1
</span></code></pre></div>
<p>because characters -- correspond to the line comment in SQL syntax, thus the query portion <code>' FROM … AND …</code>will be ignored by the SQL interpreter. The query will return the boolean value TRUE irrespective of the actual content of the database, hence the check made by the web app will be satisfied and the session will be authenticated.</p>
<p>The username that will be associated with the session depends on the structure of the code surrounding the query. In this case, the user id turns out to be 0 (probably the default value) and this id happens to be associated with the administrator account.</p>
<p>The appendix of “The Official Companion of the OWASP Juice Shop” (see section Resources) illustrates how to extract the credentials of all users and how to exfiltrate the entire database of the application by means of SQL injection.</p>
<h4 id="more-sql-injection-in-login-page">More SQL Injection in login page</h4>
<p>In case a username is known, it is possible to login with that username as follows:</p>
<ul>
<li>Open the login page.</li>
<li>Insert <code>username'--</code> as username (note the single quote character <code>'</code>at the end of the username) and any string as password.</li>
</ul>
<p>The webapp will show a successful login with the selected username.</p>
<p>In this case the SQL injection payload need not contain <code>1=1</code>. As it turns out, the code of the web app is such that the provided payload suffices to satisfy the check and to impersonate the target username.</p>


  




                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["search.suggest", "search.highlight", "navigation.instant", "navigation.tracking"], "search": "../../assets/javascripts/workers/search.dfff1995.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.78eede0e.min.js"></script>
      
    
  </body>
</html>